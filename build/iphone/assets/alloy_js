var _=require('/alloy/underscore')._,Backbone=require('/alloy/backbone'),CONST=require('/alloy/constants');exports.version='1.10.7',exports._=_,exports.Backbone=Backbone;var DEFAULT_WIDGET='widget',TI_VERSION=Ti.version,MW320_CHECK=!1,IDENTITY_TRANSFORM=void 0,RESET={bottom:null,left:null,right:null,top:null,height:null,width:null,shadowColor:null,shadowOffset:null,backgroundImage:null,backgroundRepeat:null,center:null,layout:null,backgroundSelectedColor:null,backgroundSelectedImage:null,opacity:1,touchEnabled:!0,enabled:!0,horizontalWrap:!0,zIndex:0,backgroundColor:null,font:null,visible:!0,color:null,transform:null,backgroundGradient:{},borderColor:'transparent',borderRadius:0,borderWidth:0};RESET=_.extend(RESET,{backgroundLeftCap:0,backgroundTopCap:0});function ucfirst(a){return a?a[0].toUpperCase()+a.substr(1):a}function addNamespace(a){return(CONST.IMPLICIT_NAMESPACES[a]||CONST.NAMESPACE_DEFAULT)+'.'+a}exports.M=function(a,b,c){var d,e=(b||{}).config||{},f=e.adapter||{},g={},h={};f.type?(d=require('/alloy/sync/'+f.type),g.sync=function(a,b,c){return d.sync(a,b,c)}):g.sync=function(a,b){Ti.API.warn('Execution of '+a+'#sync() function on a model that does not support persistence'),Ti.API.warn('model: '+JSON.stringify(b.toJSON()))},g.defaults=e.defaults,c&&(h.migrations=c),d&&_.isFunction(d.beforeModelCreate)&&(e=d.beforeModelCreate(e,a)||e);var i=Backbone.Model.extend(g,h);return i.prototype.config=e,_.isFunction(b.extendModel)&&(i=b.extendModel(i)||i),d&&_.isFunction(d.afterModelCreate)&&d.afterModelCreate(i,a),i},exports.C=function(a,b,c){var d,e={model:c},f=(c?c.prototype.config:{})||{};f.adapter&&f.adapter.type?(d=require('/alloy/sync/'+f.adapter.type),e.sync=function(a,b,c){return d.sync(a,b,c)}):e.sync=function(a,b){Ti.API.warn('Execution of '+a+'#sync() function on a collection that does not support persistence'),Ti.API.warn('model: '+JSON.stringify(b.toJSON()))};var g=Backbone.Collection.extend(e);return g.prototype.config=f,_.isFunction(b.extendCollection)&&(g=b.extendCollection(g)||g),d&&_.isFunction(d.afterCollectionCreate)&&d.afterCollectionCreate(g),g},exports.UI={},exports.UI.create=function(a,b,c){c=c||{};var d,e,f=b.split('.');if(1===f.length)d=b,e=c.ns||CONST.IMPLICIT_NAMESPACES[d]||CONST.NAMESPACE_DEFAULT;else if(1<f.length)d=f[f.length-1],e=f.slice(0,f.length-1).join('.');else throw'Alloy.UI.create() failed: No API name was given in the second parameter';c.apiName=e+'.'+d,d=d[0].toUpperCase()+d.substr(1);var g=exports.createStyle(a,c);return eval(e)['create'+d](g)},exports.createStyle=function(a,b,c){var d,e;if(!b)return{};d=_.isArray(b.classes)?b.classes.slice(0):_.isString(b.classes)?b.classes.split(/\s+/):[],e=b.apiName,e&&-1===e.indexOf('.')&&(e=addNamespace(e));var f=a&&_.isObject(a)?require('/alloy/widgets/'+a.widgetId+'/styles/'+a.name):require('/alloy/styles/'+a);var g,h,i={};for(g=0,h=f.length;g<h;g++){var j=f[g],k=j.key;if(j.isApi&&-1===k.indexOf('.')&&(k=(CONST.IMPLICIT_NAMESPACES[k]||CONST.NAMESPACE_DEFAULT)+'.'+k),j.isId&&b.id&&j.key===b.id||j.isClass&&_.contains(d,j.key));else if(!j.isApi)continue;else if(-1===j.key.indexOf('.')&&(j.key=addNamespace(j.key)),j.key!==e)continue;j.queries&&j.queries.formFactor&&!exports[j.queries.formFactor]||j.queries&&j.queries.if&&('false'===j.queries.if.trim().toLowerCase()||-1!==j.queries.if.indexOf('Alloy.Globals')&&!1===exports.Globals[j.queries.if.split('.')[2]])||exports.deepExtend(!0,i,j.style)}var l=_.omit(b,[CONST.CLASS_PROPERTY,CONST.APINAME_PROPERTY]);return exports.deepExtend(!0,i,l),i[CONST.CLASS_PROPERTY]=d,i[CONST.APINAME_PROPERTY]=e,MW320_CHECK,c?_.defaults(i,c):i};function processStyle(a,b,c,d,e){d=d||{},d.classes=c,b.apiName&&(d.apiName=b.apiName),b.id&&(d.id=b.id),b.applyProperties(exports.createStyle(a,d,e)),!1}exports.addClass=function(a,b,c,d){if(!c)return void(d&&(MW320_CHECK,b.applyProperties(d)));var e=b[CONST.CLASS_PROPERTY]||[],f=e.length;c=_.isString(c)?c.split(/\s+/):c;var g=_.union(e,c||[]);return f===g.length?void(d&&(MW320_CHECK,b.applyProperties(d))):void processStyle(a,b,g,d)},exports.removeClass=function(a,b,c,d){c=c||[];var e=b[CONST.CLASS_PROPERTY]||[],f=e.length;if(!f||!c.length)return void(d&&(MW320_CHECK,b.applyProperties(d)));c=_.isString(c)?c.split(/\s+/):c;var g=_.difference(e,c);return f===g.length?void(d&&(MW320_CHECK,b.applyProperties(d))):void processStyle(a,b,g,d,RESET)},exports.resetClass=function(a,b,c,d){c=c||[],c=_.isString(c)?c.split(/\s+/):c,processStyle(a,b,c,d,RESET)},exports.createWidget=function(a,b,c){return'undefined'!=typeof b&&null!==b&&_.isObject(b)&&!_.isString(b)&&(c=b,b=DEFAULT_WIDGET),new(require('/alloy/widgets/'+a+'/controllers/'+(b||DEFAULT_WIDGET)))(c)},exports.createController=function(a,b){return new(require('/alloy/controllers/'+a))(b)},exports.createModel=function(a,b){return new(require('/alloy/models/'+ucfirst(a)).Model)(b)},exports.createCollection=function(a,b){return new(require('/alloy/models/'+ucfirst(a)).Collection)(b)};function isTabletFallback(){return 700<=Math.min(Ti.Platform.displayCaps.platformHeight,Ti.Platform.displayCaps.platformWidth)}exports.isTablet=function(){return'ipad'===Ti.Platform.osname}(),exports.isHandheld=!exports.isTablet,exports.Globals={},exports.Models={},exports.Models.instance=function(a){return exports.Models[a]||(exports.Models[a]=exports.createModel(a))},exports.Collections={},exports.Collections.instance=function(a){return exports.Collections[a]||(exports.Collections[a]=exports.createCollection(a))},exports.CFG=require('/alloy/CFG'),!1,exports.deepExtend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for('boolean'==typeof g&&(j=g,g=arguments[1]||{},h=2),'object'==typeof g||_.isFunction(g)||(g={});h<i;h++)if(a=arguments[h],null!=a)for(b in'string'==typeof a&&(a=a.split('')),a)(c=g[b],d=a[b],g!==d)&&(j&&d&&!_.isFunction(d)&&_.isObject(d)&&((e=_.isArray(d))||!_.has(d,'apiName'))?(e?(e=!1,f=c&&_.isArray(c)?c:[]):_.isDate(d)?f=new Date(d.valueOf()):f=c&&_.isObject(c)?c:{},g[b]=exports.deepExtend(j,f,d)):g[b]=d);return g};